{% extends 'base.html.twig' %}

{% block title %}Услуги{% endblock %}
{% block breadcrumbs %} <p class="breadcrumbs" data-scrollax="properties: { translateY: '30%', opacity: 1.6 }"><span
            class="mr-2"><a href="{{ path('app_home') }}">Home</a></span> <span>Services</span></p> {% endblock %}

{% block body %}
    <style>
        * {
            box-sizing: border-box;
        }

        #myInput {
            background-image: url('/css/searchicon.png');
            background-position: 10px 10px;
            background-repeat: no-repeat;
            margin-left: 10%;
            width: 80%;
            font-size: 16px;
            padding: 12px 20px 12px 40px;
            border: 1px solid #ddd;
            margin-bottom: 12px;
        }

        #services {
            border-collapse: collapse;
            width: 80%;
            border: 1px solid #ddd;
            font-size: 18px;
        }

        #services th, #services td {
            text-align: left;
            padding: 12px;
        }

        #services tr {
            border-bottom: 1px solid #ddd;
        }

        #services tr.header, #services tr:hover {
            background-color: #f1f1f1;
        }
    </style>
    <section class="ftco-section">
        <div class="container">
            <div class="row">
                <div class="col-md-4 ftco-animate">
                    <div class="media d-block text-center block-6 services">
                        <div class="icon d-flex mb-3"><span class="flaticon-facial-treatment"></span></div>
                        <div class="media-body">
                            <h3 class="heading">Skin &amp; Beauty Care</h3>
                            <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                                unorthographic.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 ftco-animate">
                    <div class="media d-block text-center block-6 services">
                        <div class="icon d-flex mb-3"><span class="flaticon-cosmetics"></span></div>
                        <div class="media-body">
                            <h3 class="heading">Makeup Pro</h3>
                            <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                                unorthographic.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 ftco-animate">
                    <div class="media d-block text-center block-6 services">
                        <div class="icon d-flex mb-3"><span class="flaticon-curl"></span></div>
                        <div class="media-body">
                            <h3 class="heading">Hair Style</h3>
                            <p>Even the all-powerful Pointing has no control about the blind texts it is an almost
                                unorthographic.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section class="ftco-section ftco-discount img" style="background-image: url({{ absolute_url(asset('build/images/bg_2.jpg'))}});">
        <div class="overlay"></div>
        <div class="container">
            <div class="row justify-content-end">
                <div class="col-md-5 discount ftco-animate">
                    <h3>Save up to 25% Off</h3>
                    <h2 class="mb-4">Student Discount</h2>
                    <p class="mb-4">Even the all-powerful Pointing has no control about the blind texts it is an almost
                        unorthographic life One day however a small line of blind text by the name of Lorem Ipsum
                        decided to leave for the far World of Grammar.</p>
                    <p><a href="{{ path('app_home') }}#booking" class="btn btn-white btn-outline-white px-4 py-3">Book
                            Now</a></p>
                </div>
            </div>
        </div>
    </section>

    <section class="ftco-section ftco-counter img" id="section-counter" style="background-image: url({{ absolute_url(asset('build/images/bg_4.jpg'))}});">
        <div class="overlay"></div>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-6 col-lg-3 d-flex justify-content-center counter-wrap ftco-animate">
                            <div class="block-18 text-center">
                                <div class="text">
                                    <div class="icon"><span class="flaticon-flower"></span></div>
                                    <span>Makeup Over Done</span>
                                    <strong class="number" data-number="3500">0</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 d-flex justify-content-center counter-wrap ftco-animate">
                            <div class="block-18 text-center">
                                <div class="text">
                                    <div class="icon"><span class="flaticon-flower"></span></div>
                                    <span>Procedure</span>
                                    <strong class="number" data-number="1000">0</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 d-flex justify-content-center counter-wrap ftco-animate">
                            <div class="block-18 text-center">
                                <div class="text">
                                    <div class="icon"><span class="flaticon-flower"></span></div>
                                    <span>Happy Client</span>
                                    <strong class="number" data-number="3000">0</strong>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 d-flex justify-content-center counter-wrap ftco-animate">
                            <div class="block-18 text-center">
                                <div class="text">
                                    <div class="icon"><span class="flaticon-flower"></span></div>
                                    <span>Skin Treatment</span>
                                    <strong class="number" data-number="900">0</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <h2 align="center">Наши услуги</h2>

    <input type="text" id="myInput" onkeyup="searchByName()" placeholder="Search for names.." title="Type in a name">

    <select name="category" id="categoriesDropdown">
        <option value=""></option>
        {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
        {% endfor %}
    </select>

    <div class="tableContainer">
        <table align="center" id="services">
            <tr class="header">
                <th style="width:30%;">Название</th>
                <th style="width:50%;">Описание</th>
                <th style="width:10%;">Цена</th>
                <th style="width:10%;"></th>
            </tr>
            {% for service in services %}
                <tr>
                    <td>{{ service.name }}</td>
                    <td>{{ service.description }}</td>
                    <td>{{ price(service.price) }}</td>
                    <td>
                        <a href="{{ path('app_booking', {'serviceId' : service.id}) }}">
                            <button type="button" class="btn btn-primary">Записаться</button>
                        </a>
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.1.js"
            integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            console.log("jQuery is ready");
            $(document).on("change", "#categoriesDropdown", function (event) {
                event.preventDefault();
                var value = $(this).val();
                console.log("Category is changed");
                $.ajax({
                    url: '{{ (path('app_service_by_category', {'case' : 'list'})) }}',
                    type: "POST",
                    data: {
                        "categoryId": value
                    },
                    success: function (data) {
                        console.log(data);
                        $('.tableContainer').html(data);
                    },
                    error: function (err) {
                        console.log(err.statusText);
                    }
                });

                return false;
            })
        });

        function searchByName() {
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("services");
            tr = table.getElementsByTagName("tr");
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[0];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    </script>
{% endblock %}
